# 14.2 Probar tus servicios con Postman

Puedes consultar la sección [4.4 Probando tus servicios con POSTMAN](https://abi.gitbook.io/net-core/4.-creando-tu-primer-servicio/4.4-probando-tus-servicios-con-postman) si deseas consultar los conceptos básicos para probar con postman.

### Pasos para probar con Postman

Los pasos básicos para probar con Postman son:

1. Crear una colección
2. Agregar los diferentes request a tu colección para probar todos los casos \(correctos e incorrectos\). Puedes agruparlos en carpetas para mejor organización y compartir código.
3. Agregar con javascript todos tus assert en el tab Test
4. Si deseas probar en diferentes servidores \(Desarrollo, Pruebas, Producción\) crear un environmnent para configuar  la URL de cada servidor
5. Si deseas probar el mismo servicio con diferentes valores  puedes crear un archivo csv  con los diferentes valores que deseas probar.

### Crear una colección para probar el Login

1. Da clic en el botón **+ New Collection** o en el botón **+ Create Collection**
2. En **name** teclea el nombre de la colección, por ejemplo teclea el nombre del servicio que deseas probar. En este ejemplo es Login
3. **Description**: Agrega la descripción del servicio y los casos que deseas probar, utiliza markdown. En mi caso agregué una nota indicando que el caso de envio de código por usuario incorrecto se puede probar como integración y no con postman.
4. Da clic en el botón **Create**.

![](../.gitbook/assets/image%20%28526%29.png)

Puedes organizar los test de acuerdo al status code. Para este servicio crea las siguientes carpetas:

* 200 
* 400
* 403

5. Crea una carpeta dando clic en los **...** y luego en **Add Folder**

![](../.gitbook/assets/image%20%28529%29.png)

6. Agrega el nombre y descripción y da clic en **Create**

![](../.gitbook/assets/image%20%28530%29.png)

### Crear el request para llamar el servicio login

1. Da clic en **Add requests** configura lo siguiente:

* **Request name:** agrega un nombre, al igual que los test unitarios, te recomiendo que el nombre sea el nombre del servicio, a continuación el caso y por último lo que esperas obtener. En este ejemplo es: **Login\_UsuarioPasswordCorrectos\_Return200Token.** 
* **Request description:** Agrega una descripción mas detallada del caso

![](../.gitbook/assets/image%20%28527%29.png)

2. Da clic en **Save to 200**

3.Configura los datos necesarios para ejecutar el servicio:

* **Método**: Es el método de tu servicio. En este caso el login es **POST**
* **Request Url**: La url del serivicio a probar. [http://localhost:5000/api/Usuarios/Login](http://localhost:5000/api/Usuarios/Login)
* **Tipo**: Selecciona **raw** para indicar que es texto y no viene de una forma ni de un archivo ni es tipo GraphQL
* **Content-Type**: Selecciona **JSON** ya que enviaremos un JSON
* **Body**: Agrega el json requerido para tu servicio. Para el servicio login se necesita:

```text
{
  "Usuario": "Juan",
  "Password": "password del usuario"
}
```

![](../.gitbook/assets/image%20%28531%29.png)

4. Da clic en **Send** para llamar el servicio y obtener el resultado

### Funciones para probar tus servicios

Postman cuenta con algunas funciones ya definidas y algunas liberías javascript paraa probar tus servicios.

La sintaxis básica es:

```text
pm.test("Descripción del caso de prueba", function() {
    //código para la prueba
    pm.expect("valor esperado").to.eql("valor")
});
```

Para indicar que quieres agregar un nuevo caso de prueba es con el objeto **pm** luego **.** luego la función **test** entre paréntesis el primer parámetro es la **descripción del test**, luego una función. 

Por lo general el código para probar es con pm luego el . luego la función expect como parámetro agregas el valor esperado y luego el valor y la condición que deseas probar en el ejemplo se prueba que sea igual a un valor

