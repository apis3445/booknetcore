# 7.12 Seguridad basada en directivas

Puedes utilizar la clase de .NET [OperationAuthorizationRequirement](https://docs.microsoft.com/es-es/dotnet/api/microsoft.aspnetcore.authorization.infrastructure.operationauthorizationrequirement)  la cual nos facilita registrar todos los posibles permiso que maneja tu aplicación. Creamos una clase **Operaciones** en nuestra carpeta **Core** y agregamos los tipos de permisos que manejará nuestra aplicación.

{% code-tabs %}
{% code-tabs-item title="Operaciones.cs" %}
```csharp
public static class Operaciones
{
    public static OperationAuthorizationRequirement Crear = new
            OperationAuthorizationRequirement
    { Name = "Crear" };
    public static OperationAuthorizationRequirement Modificar = new
            OperationAuthorizationRequirement
    { Name = "Modificar" };
    public static OperationAuthorizationRequirement Borrar = new
            OperationAuthorizationRequirement
    { Name = "Borrar" };
    public static OperationAuthorizationRequirement Consultar = new
            OperationAuthorizationRequirement
    { Name = "Consultar" };
}
```
{% endcode-tabs-item %}
{% endcode-tabs %}

Creamos una clase PermisoDTO el cual nos indica que tabla deseamos validar, y también indicamos una variable SoloAdministradores en el cual si esta en true esta tabla sólo es accesible a los usuarios con el rol de Administrador.

Para nuestras reglas personalizadas necesitamos que nuestra clase herede de **AuthorizationHandler,** la cual recibe como objetos genéricos un objeto de la clase OperationAuthorizationRequirement y cualquier otro dato adicional en nuestro caso es nuestra clase **PermisoDTO.**

\*\*\*\*

