# 7.7 Creando nuestro servicio de login y generar el token

Vamos a crear nuestro servicio de login en el cual además de validar al usuario vamos a regresar el token. Según que tanta seguridad necesite tu aplicación puedes darle un tiempo de vida mas largo o mas corto. En mi caso como es una aplicación sencilla que no maneja datos muy confidenciales le dejaré un tiempo de 15 días. Para aplicaciones que manejen información mas confidencial puedes darle tiempo de una hora. También si quieres probar que los token caducan y el servicio para refresacar el token puedes darle un tiempo mas corto para pruebas de 2 minutos, solamente para que no debas esperar a que expiren los tokens.

Vamos a crear una carpeta llamda DTO \(Data Transfer Object\) en esta carpeta vamos a guardar archivos que necesitamos para nuestros servicios pero que no pertenecen a ninguna tabla, por ejemplo vamos a crear una clase llamada TokenDTO para regresar los datos del Token cuando un usuario inicia sesión correctamente.

{% code-tabs %}
{% code-tabs-item title="TokenDTO" %}
```csharp
public class TokenDTO
{
    public string Token { get; set; }
    
    public DateTime TokenExpiration { get; set; }
    
    public string Nombre { get; set; }

    public string RefreshToken { get; set; }
}
```
{% endcode-tabs-item %}
{% endcode-tabs %}

Agregamos otro clase llamada LoginDTO el cual va a incluir los datos que necesitamos para realizar el login, para empezar solo pediremos usuario y contraseña.

{% code-tabs %}
{% code-tabs-item title="LoginDTO" %}
```csharp
public class LoginDTO
{

    /// <summary>
    /// Usuario
    /// </summary>
    [Required(ErrorMessage = "Required")]
    [StringLength(15)]
    public string Usuario { get; set; }

    /// <summary>
    /// Password del usuario
    /// </summary>
    [Required(ErrorMessage = "Required")]
    [StringLength(255)]
    public string Password { get; set; }

}
```
{% endcode-tabs-item %}
{% endcode-tabs %}

En nuestro archivo UsuarioDAO agregamos los métodos para modificar, borrar y para consultar



Agregamos un nuevo controller \(**UsuariosController**\) para los servicios de los usuarios puedes ver el siguiente [link](https://abi.gitbook.io/net-core/4.-creando-tu-primer-servicio/4.3-creando-el-servicio) para recordar como crear un nuevo controller.





