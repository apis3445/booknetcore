# 7.8.1 ¿Cómo limitar el número de intentos incorrectos en el login?

Para evitar que un hacker intente adivinar el usuario y password, lo que suelen hacer es generar scrpits para combinar muchas combinaciones de usuario y contraseñas, algunas de las sugerencias que se recomienda es limitar el número de intentos incorrectos, para que por ejemplo después de 5 intentos incorrectos se envíe un email al usuario indicando que debido a tantos intentos incorrectos ahora debe teclear un código. 

El código sería de la siguiente manera

![](../../.gitbook/assets/image%20%2885%29.png)

1. Se revisa si existe un código de bloqueo
   1. Si existe se regresa el error de que la cuenta esta bloqueada
   2. No existe código de bloqueo, se revisa que el usuario/password sea correcto
      1. Si es incorrecto se revisa que el número de intentos sea menor a 5
         1. Si es menor a 5 se regresa un error 400 indicando que el usuario/password es incorrecto
         2. Si no se envia el código de bloqueo al correo del usuario y se regresa un error 423 indicado que el usuario ha sido bloquedo. El código será un número aleatorio de 6 cifras.
      2. Si no es incorrecto se guarda en 0 el número de intentos incorrectos y el código  



